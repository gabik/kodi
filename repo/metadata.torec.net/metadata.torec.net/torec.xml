<?xml version="1.0" encoding="UTF-8"?>
<scraper framework="1.1" date="2011-04-22" >
	<CreateSearchUrl dest="3">
		<RegExp input="$$1" output="&lt;url post=&quot;yes&quot;&gt;http://www.torec.net/ssearch.asp?search=\1|User-Agent=Mozilla%2F4.0%20(compatible%3B%20MSIE%207.0%3B%20Windows%20NT%206.0)&lt;/url&gt;" dest="3">
			<expression noclean="1" />
		</RegExp>
	</CreateSearchUrl>
	<GetSearchResults dest="8">
		<RegExp input="$$5" output="&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot; standalone=&quot;yes&quot;?&gt;&lt;results&gt;\1&lt;/results&gt;" dest="8">
			<RegExp input="$$1" output="&lt;entity&gt;&lt;title&gt;\2&lt;/title&gt;&lt;url&gt;http://www.torec.net/sub.asp?sub_id=\1|User-Agent=Mozilla%2F4.0%20(compatible%3B%20MSIE%207.0%3B%20Windows%20NT%206.0)&lt;/url&gt;&lt;/entity&gt;" dest="5">
				<expression repeat="yes" clear="yes" noclean="1">&lt;a href="sub.asp\?sub_id=([0-9]*)"&gt;(.{0,90})</expression>
			</RegExp>
			<expression clear="yes" noclean="1" />
		</RegExp>
	</GetSearchResults>
	<GetDetails dest="3">
		<RegExp input="$$5" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
			<!-- imdb ID -->
			<RegExp input="$$1" output="&lt;id&gt;\1&lt;/id&gt;" dest="5+">
				<expression clear="yes" noclean="1">tt(\d{1,10})</expression>
			</RegExp>
			<!-- Hebrew Title -->
			<RegExp input="$$1" output="&lt;title&gt;\1&lt;/title&gt;" dest="5+">
				<expression trim="1" noclean="1">(?&lt;=&lt;h1&gt;)(.*?)(?=\&lt;)</expression>
			</RegExp>
			<RegExp input="$$1" output="\1" dest="8">
				<expression trim="1">(?&lt;=&lt;bdo dir="ltr"&gt;)(.*?)(?=\&lt;)</expression>
			</RegExp>
			<RegExp input="$$8" output="&lt;originaltitle&gt;\1&lt;/originaltitle&gt;" dest="5+">
				<expression/>
			</RegExp>
			<!-- Year -->
			<RegExp input="$$1" output="&lt;year&gt;\1&lt;/year&gt;" dest="5+">
				<expression trim="1">(?&lt;=שנה:&lt;\/strong&gt;)(.*?)(?=&lt;br&gt;)</expression>
			</RegExp>
			<!-- Director -->
			<RegExp input="$$1" output="&lt;director&gt;\1&lt;/director&gt;" dest="5+">
				<expression trim="1">(?&lt;=במאי:&lt;\/strong&gt;)(.*?)(?=&lt;br&gt;)</expression>
			</RegExp>
			<!-- Plot -->
			<RegExp input="$$1" output="&lt;plot&gt;\1&lt;/plot&gt;" dest="5+">
				<expression>(?&lt;=sub_name_div"&gt;)(.*?)(?=&lt;\/div&gt;)</expression>
			</RegExp>
			<!-- Genre -->
			<RegExp input="$$1" output="\1" dest="7">
				<expression noclean="1">(?&lt;=אנר:&lt;\/strong&gt;)(.*?)(?=&lt;br&gt;)</expression>
			</RegExp>
			<RegExp input="$$7" output="&lt;genre&gt;\0&lt;/genre&gt;" dest="5+">
				<expression repeat="yes">^(.{0,10})(?=\s\/)|(?&lt;=\/\s)(.*?)(?=\/\s)|(?&lt;=\/\s)(.*)</expression>
			</RegExp>
			<!-- Actors -->
			<RegExp input="$$1" output="\1" dest="7">
				<expression noclean="1">(?&lt;=שחקנים:&lt;\/strong&gt;)(.*?)(?=&lt;\/span&gt;)</expression>
			</RegExp>
			<RegExp conditional="!fullcredits" input="$$7" output="&lt;actor&gt;&lt;name&gt;\1&lt;/name&gt;&lt;role&gt;&lt;/role&gt;&lt;/actor&gt;" dest="5+">
				<expression repeat="yes" trim="1">(?&lt;="&gt;)(.*?)(?=&lt;\/a&gt;)</expression>
			</RegExp>
			<RegExp conditional="fullcredits" input="$$7" output="&lt;chain function=&quot;GetFullActorDetails&quot;&gt;\1&lt;/chain&gt;" dest="5+">
				<expression repeat="yes" trim="1">(?&lt;="&gt;)(.*?)(?=&lt;\/a&gt;)</expression>
			</RegExp>
			<!-- Rating -->
			<RegExp input="$$1" output="&lt;rating&gt;\1&lt;/rating&gt;&lt;votes&gt;\2&lt;/votes&gt;" dest="5+">
				<expression trim="1">(?&lt;=&lt;br \/&gt;דרוג)(.*?),(.*?)(?=\ה)</expression>
			</RegExp>
			<!-- Thumb (Cover) -->
			<RegExp input="$$1" output="&lt;thumb&gt;http://www.torec.net/\1&lt;/thumb&gt;" dest="5+">
				<expression trim="1">(?&lt;="flashvars" value="image=)(.*?)(?=")</expression>
			</RegExp>
			<!-- Fan Art -->
			<RegExp input="$INFO[fanart]" output="&lt;chain function=&quot;GetTMDBFanartByIdChain&quot;&gt;$$9&lt;/chain&gt;" dest="5+">
				<RegExp input="$$1" output="\1" dest="9">
					<expression trim="1">http://www.imdb.com/title/(tt[^"]+)</expression>
				</RegExp>
				<expression>MovieDB</expression>
			</RegExp>
			<RegExp input="$INFO[fanart]" output="&lt;chain function=&quot;GetGoogleFanart&quot;&gt;$$8&lt;/chain&gt;" dest="5+">
				<expression>Google</expression>
			</RegExp>
			<!-- Trailers -->			
			<RegExp input="$INFO[TrailerQ]" output="&lt;chain function=&quot;GetHDTrailersnet480p&quot;&gt;$$6&lt;/chain&gt;" dest="5+">
				<RegExp input="$$1" output="\1" dest="6">
					<expression noclean="1">(?&lt;=&lt;bdo dir="ltr"&gt;)(.*?)(?=\&lt;)</expression>
				</RegExp>
				<expression>480p</expression>
			</RegExp>
			<RegExp input="$INFO[TrailerQ]" output="&lt;chain function=&quot;GetHDTrailersnet720p&quot;&gt;$$6&lt;/chain&gt;" dest="5+">
				<RegExp input="$$1" output="\1" dest="6">
					<expression noclean="1">(?&lt;=&lt;bdo dir="ltr"&gt;)(.*?)(?=\&lt;)</expression>
				</RegExp>
				<expression>720p</expression>
			</RegExp>
			<RegExp input="$INFO[TrailerQ]" output="&lt;chain function=&quot;GetHDTrailersnet1080p&quot;&gt;$$6&lt;/chain&gt;" dest="5+">
				<RegExp input="$$1" output="\1" dest="6">
					<expression noclean="1">(?&lt;=&lt;bdo dir="ltr"&gt;)(.*?)(?=\&lt;)</expression>
				</RegExp>
				<expression>1080p</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetDetails>
	<!-- Get Actor With pictures -->
	<GetFullActorDetails clearbuffers="no" dest="3">
		<RegExp input="$$1" output="\1" dest="7">
			<expression noclean="1"></expression>
		</RegExp>
		<RegExp input="$$6" output="&lt;details&gt;&lt;url function=&quot;ParseActor&quot; cache=&quot;googleImage-$$1.xml&quot;&gt;http://images.google.com/images?q=\1&num=4&biw=1920&bih=1081&sout=1&tbs=isz:m,itp:face,ic:color,iar:t&lt;/url&gt;&lt;/details&gt;" dest="3">
			<RegExp input="$$1" output="\1+" dest="6">
				<expression repeat="yes" encode="1" fixchars="1" trim="1">([^\s]+)</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetFullActorDetails>
	<ParseActor dest="4">
		<RegExp input="$$7" output="&lt;details&gt;&lt;actor&gt;&lt;name&gt;\1&lt;/name&gt;" dest="4+">
			<expression noclean="1" />
		</RegExp>
		<RegExp input="$$1" output="&lt;thumb&gt;\2&lt;/thumb&gt;&lt;/actor&gt;&lt;/details&gt;" dest="4+">
			<expression>(imgurl\\x3d)(.*?)\\x</expression>
		</RegExp>
	</ParseActor>
	<!-- Get fan art from google -->
	<GetGoogleFanart dest="3">
		<RegExp input="$$5" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
			<RegExp input="$$6" output="&lt;url function=&quot;ParseGoogleFanart&quot; cache=&quot;google-images-\1.xml&quot;&gt;http://www.google.com/images?as_q=\1poster&hl=en&sout=1&biw=1920&bih=1075&output=search&tbm=isch&btnG=Google+Search&as_epq=&as_oq=&as_eq=&as_sitesearch=&safe=images&as_st=y&tbs=isz:l,itp:ic:color,iar:w&lt;/url&gt;" dest="5">
				<RegExp input="$$1" output="\1+" dest="6">
					<expression repeat="yes" fixchars="1" trim="1">([\w]+)</expression>
				</RegExp>
				<expression noclean="1"/>
			</RegExp>
			<expression noclean="1"/>
		</RegExp>
	</GetGoogleFanart>
	<ParseGoogleFanart dest="4">
		<RegExp input="$$2" output="&lt;details&gt;&lt;fanart&gt;\1&lt;/fanart&gt;&lt;/details&gt;" dest="4">
			<RegExp input="$$1" output="&lt;thumb preview=&quot;\2&quot;&gt;\2&lt;/thumb&gt;" dest="2">
				<expression noclean="1" repeat="yes">(imgurl\\x3d)(.*?)\\x</expression>
			</RegExp>
			<expression noclean="1"></expression>
		</RegExp>
	</ParseGoogleFanart>
	<!-- 480p trailers -->
	<GetHDTrailersnet480p dest="3">
		<RegExp input="$$6" output="&lt;details&gt;&lt;url function=&quot;Parse480pTrailer&quot; cache=&quot;hd-trailers-\1.xml&quot;&gt;http://xbmc.hd-trailers.net/movie/\1&lt;/url&gt;&lt;/details&gt;" dest="3">
			<RegExp input="$$1" output="\1-" dest="6">
				<expression repeat="yes" fixchars="1" trim="1">([\w]+)</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetHDTrailersnet480p>
	<Parse480pTrailer dest="4">
		<!--Fetch 480p trailer link from hdtrailers.net-->
		<RegExp input="$$1" output="&lt;details&gt;&lt;trailer&gt;\4&lt;/trailer&gt;&lt;/details&gt;" dest="4">
			<expression noclean="1">(Trailer-480p":(\s*)Mediabox\.open\((\s*)")(.*?)(?=\")</expression>
		</RegExp>
	</Parse480pTrailer>
	<!-- 720p trailers -->
	<GetHDTrailersnet720p dest="3">
		<RegExp input="$$6" output="&lt;details&gt;&lt;url function=&quot;Parse720pTrailer&quot; cache=&quot;hd-trailers-\1.xml&quot;&gt;http://xbmc.hd-trailers.net/movie/\1&lt;/url&gt;&lt;/details&gt;" dest="3">
			<RegExp input="$$1" output="\1-" dest="6">
				<expression repeat="yes" fixchars="1" trim="1">([\w]+)</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetHDTrailersnet720p>
	<Parse720pTrailer dest="4">
		<!--Fetch 720p trailer link from hdtrailers.net-->
		<RegExp input="$$1" output="&lt;details&gt;&lt;trailer&gt;\4&lt;/trailer&gt;&lt;/details&gt;" dest="4">
			<expression noclean="1">(Trailer-720p":(\s*)Mediabox\.open\((\s*)")(.*?)(?=\")</expression>
		</RegExp>
	</Parse720pTrailer>
	<!-- 1080p trailers -->
	<GetHDTrailersnet1080p dest="3">
		<RegExp input="$$6" output="&lt;details&gt;&lt;url function=&quot;Parse1080pTrailer&quot; cache=&quot;hd-trailers-\1.xml&quot;&gt;http://xbmc.hd-trailers.net/movie/\1&lt;/url&gt;&lt;/details&gt;" dest="3">
			<RegExp input="$$1" output="\1-" dest="6">
				<expression repeat="yes" fixchars="1" trim="1">([\w]+)</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetHDTrailersnet1080p>
	<Parse1080pTrailer dest="4">
		<!--Fetch 1080p trailer link from hdtrailers.net-->
		<RegExp input="$$1" output="&lt;details&gt;&lt;trailer&gt;\4&lt;/trailer&gt;&lt;/details&gt;" dest="4">
			<expression noclean="1">(Trailer-1080p":(\s*)Mediabox\.open\((\s*)")(.*?)(?=\")</expression>
		</RegExp>
	</Parse1080pTrailer>
</scraper>